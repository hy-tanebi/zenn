---
title: "WebGL・Three.js入門② ~画像・動画〜"
emoji: "🤖"
type: "tech"
topics:
  - "javascript"
  - "webgl"
  - "threejs"

published: false
---

こんにちは。この記事は、学習の備忘録としてまとめていこうと思っています。
解説を目的としているわけではなく、自身の反芻のための意味合いが強いためご容赦ください。

今回は画像・動画の導入や活用方法について。

---

## 画像表示の流れ

画像や動画は 3D グラフィックスではテクスチャと呼ばれます。
Three.js で画像を読み込み、画像をテクスチャに変換して、マテリアルに設定する、といった作業を行うことで 3D グラフィックスに適用することができます。

---

## 実装

画像表示までを実装していきます。

:::message
コードは前回記事[「WebGL・Three.js 入門 ①」](https://zenn.dev/boa/articles/209159a0aea0b1)を流用します
:::

画像からテクスチャを作成する際に非同期処理を行う必要があるので、一旦全体を async 関数で囲います。

```ts:app.js
import * as THREE from "three";

init();

// 非同期処理のためasync関数で囲む
async function init() {

 // sceneの作成
const scene = new THREE.Scene();

// cameraの作成
const camera = new THREE.PerspectiveCamera(
  75,
  window.innerWidth / window.innerHeight,
  0.1,
  1000
);

// rendererの作成
const renderer = new THREE.WebGLRenderer();
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// オブジェクトの作成
const geometry = new THREE.BoxGeometry();
const material = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
const cube = new THREE.Mesh(geometry, material);
scene.add(cube);

camera.position.z = 5;

}

```

次に画像からテクスチャを作成するために THREE.TextureLoader を使用します。
作成した texture1 をマテリアルの map プロパティに設定します。
画像パスはプロジェクトのディレクトリ構造に適宜合わせてください。

:::message
loadAsync メソッドは Promise オブジェクトを返却するため、loadAsync による非同期の処理が完了するのを待つために、先頭に await キーワードを付与を忘れずに行う。
:::

:::message
Three.js では、テクスチャのカラースペースがデフォルトで THREE.SRGBColorSpace に設定されるため、元画像の色調と異なって見える場合があります。また、レンダラーの出力カラースペース設定も影響します。影響回避のためこの投稿では、// テクスチャのカラースペースを明示的に設定、を採用しています。
:::

```ts:app.js
//ジオメトリを下記に変更
  const geometry = new THREE.PlaneGeometry(20, 10);

//画像追加
  const texLoader = new THREE.TextureLoader();

  const texture1 = await texLoader.loadAsync("./public/taxi.jpg");

// テクスチャのカラースペースを明示的に設定
  texture1.colorSpace = THREE.SRGBColorSpace;

//マテリアルに上記のtexture1をmapの値にセット
  const material = new THREE.MeshBasicMaterial({
    map: texture1,
  });

  const cube = new THREE.Mesh(geometry, material);
  scene.add(cube);

  camera.position.z = 15;

}
```

▼ 画像がシーンに表示されました。

![サンプル画像](/images/18dc242846ab67/taxi.jpg)
